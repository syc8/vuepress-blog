# 小程序开发学习-(2天) 

# * 划重点
## 1. 小程序基础及相关配置

1. appId是保证小程序的唯一性的ID,  **是跟随小程序**, 不是跟随开发者权限的Id;

   >  在开发者平台打开时, 必须要appId,  此Id关联者该小程序在开发平台的相关配置,  如: 过审的请求地址

2. 请求数据对后台地址的两个要求： 

   - 1.必须是https请求；
   - 2.请求地址必须通过微信审核的合法地址

3. 关于微信中的请求：

   - 微信不是浏览器， 不存在ajax，也不存在跨域，只要是合法的域名即可

![配置合法的域名](/img/02微信小程序-系统实践学习/配置合法的域名.png)

## 2. 原生框架部分重点

1. rpx单位自适应:  1rpx = 0.5px
2. .json文件中只能写事件绑定的函数， 普通函数用 wxs(微信提供的脚本，类似javascript但不是，只支持js中某些低级的语法)
## 3. wepy框架部分重点
1. 请求必须使用promise
- 在app.wpy中constructor对象中启用pormist :this.use('promiseify')
- 利用promise请求数据后更新的数据参数 必须调用this.$apply()方法更新
2. es7语法asncy await
3. 复习flex布局
4. 在wepy框架中可以使用微信小程序原生的wx API,但是Eslint语法监听会报错,处理到这类错误
5. 点击事件时传参写法: fuc({{id}},{{name}})
6. 数组拼接新方法: arr1 = [...arr1,...arr2]
    <IMG src="file:///C:\Users\Administrator\AppData\Roaming\feiq\RichOle\1687988244.bmp">

## 3. weui-UI库划重点

1. 基本使用
   - https://www.cnblogs.com/nosqlcoco/p/6125274.html

## 4. 踩坑

1. **tabBar不显示**
   - app.json中 **pages数组的第一项必须是tabBar的list数组的一员**。 

# 一. 介绍及基本使用

## 主要内容

1. 了解小程序是做什么的
2. 体验下小程序中最基本的能力
3. 学习小程序中开发的基础语法
4. WePY框架



## 从业务角度认识小程序
1. 什么是小程序：**微信提供服务的新形式**；
   + 公众号
   + 订阅号
   + 服务号
   + 小程序（模拟了手机App的用户体验）
2. 小程序出现的目的：拦截用户流量入口；今后用户每天，大多数的应用需求，都可从微信中得到服务；
3. 为什么有了公众号和服务号，还要有小程序？
   + 因为 `公众号` 或 `服务号`，体验差；
   + 小程序能够让用户，体验到真正类似于App的使用效果；
4. 小程序适合做什么
   + **适合做用完即走的应用**；点外卖、打车、代驾
   + 不适合做一些和用户有强制性依赖关系的应用；（王者荣耀、很流行的手机游戏）
   + 小游戏：适合做一些轻度型的游戏；



## 从技术角度认识小程序
1. 小程序和传统手机App开发方式的区别
   + **传统的手机App：**都是基于手机操作系统进行开发的；开发出来的手机App都是直接安装到 手机 操作系统上的；
   + **小程序：**并不是直接安装到手机上的，而是安装到了微信中；
2. 基于微信平台提供的运行环境，模拟类似于原生应用的体验
   + 小程序不是原生的应用；只是模拟了原生应用的体验度而已；



## 快速体验小程序
通过小程序的官方示例，了解小程序提供了哪些基本的组件、API接口

通过官方的小程序实例，可以总结出：微信小程序提供了`组件`和`接口`的概念

+ **组件**是为了方便页面布局的； image  view  text 
+ **接口**是为了提供某种能力；比如 发起网络请求、微信支付等



## 课程介绍
### 知识储备
1. HTML、CSS、Javascript
2. 最好接触过 Angular、Vue、React 之类的 MVVM 框架
3. 了解 Node.js、ES6 更好

### 课程大纲
1. 基础内容
2. UI开发
3. API操作
4. 综合实战



## 注册小程序账号

1. 注意：小程序中，如果想要请求数据，那么，提供数据的后端服务器，必须是 `HTTPS` 协议的；同时，这个 后端服务器的域名，必须被添加到`服务器域名`中；
   + `小程序后端管理首页` -> `设置` -> `开发者设置` -> `服务器域名`
2. 注意：小程序的图标、应用名称、应用描述，都可以在 `小程序后端管理首页` -> `设置` -> `基本设置` -> `前往填写`



## 创建小程序项目

1. 选择项目目录
2. 填写 AppId
3. 勾选基本模板选项



## 开发工具的基本使用

+ 菜单栏
+ 工具栏
+ 模拟器
+ 编辑器
  + 目录树
  + 代码编辑面板
+ 调试器



## 项目结构介绍

![](/img/02微信小程序-系统实践学习/02.小程序项目结构中每个文件的作用.png)

1. `pages`目录：存放的是所有小程序中的页面；
2. `utils`目录：存放的是一些工具函数，比如格式化时间的；
3. `app.js`文件：小程序运行时候的入口文件；如果小程序要启动，则一定是优先执行此文件；
4. `app.json`文件：小程序的全局配置文件，比如配置小程序导航条的颜色；
5. `app.wxss`文件：`.wxss`是小程序中的样式表后缀名，这个`app.wxss`是小程序的全局样式；也就是说，小程序中所有的页面，都会受到`app.wxss`样式表的控制；
6. `project.config.js`文件：小程序项目中，项目基本的参数配置；（不重要）



### 标签介绍

- page

- view : 代表所有块级标签
- text : 代表所有行内标签



## 页面结构介绍

1. 在Vue中，每个组件，都定义到了`.vue`文件中； 
   + `<template>`
   + `<script>`
   + `<style>`
2. 在小程序中，每个页面，都放到了 `pages`目录中，同时，每个页面，都是以单独的目录名来进行管理的；
   + `.wxml`UI结构
   + `.js`页面的行为
   + `.wxss`页面的样式
   + `.json`页面配置文件
3. 注意： 项目的首页，就是 `app.json`中，`pages`节点下，第一个页面路径；



## [在页面中使用样式](https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxss.html)

1. 标签选择器
2. 类选择器
3. Id选择器
4. `data-*` 属性选择器
5. 小程序中的尺寸单位`rpx`
   - 注意：在美工给的图中，一般都是以 Iphone6 的宽度， 作为设计稿的模型；
   - 在 Iphone6 上， 1px = 2rpx
   - 所以，今后我们在使用 像素单位的时候，  在页面上放一个 宽 80px 高 30px 的按钮，对应设置 宽高的时候，可以使用 160rpx 的 宽 和  60rpx 的高
6. 使用`@import "路径";`来导入外联样式表（注意：分号不要丢了）





## 全局配置文件`app.json`

### 快速创建新页面

+ 在小程序调试工具中，手动打开全局的配置文件`app.json`, 找到`pages`节点，新增自己的页面路径之后，小程序调试工具，会自动帮我们创建页面；
+ 约定：在 `app.json`的`pages`节点中，默认第一个路径，就是小程序的首页；

### 配置窗口外观

### 配置Tab栏



## 应用的生命周期

1. 小程序在启动的时候，必然会优先执行 `app.js`
2. 在执行 `app.js` 的时候，可以调用 `App({ /* 配置对象 */ })` 方法，对整个小程序，做一些全局的控制；



## 页面的生命周期



## 数据绑定和WXS

1. 向页面的text中绑定数据
2. 通过`bindinput`和`e.detail.value`监听文本框数据的变化
3. 如果要为 `data` 中的数据重新赋值，需要使用 `this.setData({ /* 数据对象 */ })` 方法
4. 在`.wxml`中使用`wxs`对页面上展示的数据进行格式化输出



## 条件渲染

1. `wx:if={{condition}}`和`wx:else`
2. `hidden={{condition}}`



## 列表渲染

1. `wx:for={{condition}}`
2. 默认每一项的索引为`index`，每一项为`item`
3. `wx:for-index=""`和`wx:for-item=""`
4. `wx:key=""`



## 事件处理机制

1. 为按钮绑定点击事件

   ```html
   <button bindtap='toggleFlag' type='primary'>Toggle</button>
   ```

2. 为文本框绑定输入事件：

   ```html
   <input bindinput='txtchanged'></input>
   ```

3. 注意：为元素绑定事件时，绑定的事件处理函数，不必使用`{{}}`进行包裹；



## 页面之间传值

1. 通过页面url地址拼接

   - 传递

   ![1534318495807](/img/02微信小程序-系统实践学习/1534318495807.png)

   - 获取

     ![1534318537483](/img/02微信小程序-系统实践学习/1534318537483.png)

2. 通过 `app.global` 在全局挂载参数

   - 全局挂载

   ![1534318332793](/img/02微信小程序-系统实践学习/1534318332793.png)

   - 局部当中获取

   ![1534318281649](/img/02微信小程序-系统实践学习/1534318281649.png)

   - 局部当操作

   ![1534318232673](/img/02微信小程序-系统实践学习/1534318232673.png)

3. 通过本地存储api方法: ` wx.setStorageSync` (同步储存) &  `wx.getStorageSync`  (同步获取)

   - 最大支持10M内存

   - 可同步可异步

     ![1534318136728](/img/02微信小程序-系统实践学习/1534318136728.png)

## 页面之间的导航

1. 使用`<navigator>`组件实现标签式跳转：

   ```jsx
   <!--使用导航组件，跳转到列表页面  -->
   <navigator url="/pages/list/list?type=top250&page=1">使用导航组件，跳转到列表页面</navigator>
   ```

2. 使用编程式跳转：

   ```js
   wx.navigateTo({
     url: '/pages/list/list?type=coming_soon&page=2' // 要跳转到的地址
   })
   ```



## 发起Ajax数据请求

【get请求地址】`https://locally.uieee.com/slides`

+ 通过使用 `wx.request(OBJECT)` 方法发起Ajax请求
+ 1. 后台提供的 接口，必须是 https 协议
  2. 小程序中，请求的 API 接口地址的域名，必须在后台的 `服务器域名  ` 添加一下配置；否则无法调用成功！

## 组件

### 地图组件

- api

  - 创建地图组件控制对象

    ```var map = wx.createdMapContext('id',this)```



### picker组件

#### 1. picker组件按照官方方法使用, 选中某项后并没有将选中内容显示到页面

- **普通选择器**

  value在组件中只作下标使用, 所以picker元素本身并不会显示选中的值, 可在其内部写元素: arr[index] 这样达到显示的效果

```html
  <picker bindchange="bindPickerChange" value="{{index}}" range="{{array}}">
    <view class="picker">
      当前选择：{{array[index]}}
    </view>
  </picker>
```



#  二. 项目实践-wePy

## 创建项目并设置tab栏



## 创建首页轮播图并动态请求轮播图数据

1. 注意：微信小程序中，不存在跨域限制；
2. 小程序中，请[求数据](https://mp.weixin.qq.com/debug/wxadoc/dev/api/network-request.html)，可以使用`wx.request({})`



## 绘制首页九宫格



## 跳转到`list`列表页面



## 跳转到`detail`详情页



## API地址

1. 获取轮播图
   - 【get请求】`https://locally.uieee.com/slides`
2. 获取九宫格
   - 【get请求】`https://locally.uieee.com/categories`
3. 获取商铺分页列表
   - 【get请求】`https://locally.uieee.com/categories/分类Id/shops?_page=页码&_limit=每页显示几条数据`
   - `_page` 为第几页数据
   - `_limit` 为获取几条数据
4. 获取店铺详情
   - 【get请求】`https://locally.uieee.com/shops/店铺Id`



## ESLint

1. `// eslint-disable-next-line no-undef `